<html lang="de" data-theme="light"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wohnkosten â€“ proportional zum Netto (mit Sicherheitsmarge)</title>


  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script><style>/*! tailwindcss v4.1.14 | MIT License | https://tailwindcss.com */
@layer properties;
@layer theme, base, components, utilities;
@layer theme {
  :root, :host {
    --font-sans: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
    'Noto Color Emoji';
    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New',
    monospace;
    --spacing: 0.25rem;
    --text-xs: 0.75rem;
    --text-xs--line-height: calc(1 / 0.75);
    --text-sm: 0.875rem;
    --text-sm--line-height: calc(1.25 / 0.875);
    --text-lg: 1.125rem;
    --text-lg--line-height: calc(1.75 / 1.125);
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    --default-font-family: var(--font-sans);
    --default-mono-font-family: var(--font-mono);
  }
}
@layer base {
  *, ::after, ::before, ::backdrop, ::file-selector-button {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    border: 0 solid;
  }
  html, :host {
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    tab-size: 4;
    font-family: var(--default-font-family, ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji');
    font-feature-settings: var(--default-font-feature-settings, normal);
    font-variation-settings: var(--default-font-variation-settings, normal);
    -webkit-tap-highlight-color: transparent;
  }
  hr {
    height: 0;
    color: inherit;
    border-top-width: 1px;
  }
  abbr:where([title]) {
    -webkit-text-decoration: underline dotted;
    text-decoration: underline dotted;
  }
  h1, h2, h3, h4, h5, h6 {
    font-size: inherit;
    font-weight: inherit;
  }
  a {
    color: inherit;
    -webkit-text-decoration: inherit;
    text-decoration: inherit;
  }
  b, strong {
    font-weight: bolder;
  }
  code, kbd, samp, pre {
    font-family: var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace);
    font-feature-settings: var(--default-mono-font-feature-settings, normal);
    font-variation-settings: var(--default-mono-font-variation-settings, normal);
    font-size: 1em;
  }
  small {
    font-size: 80%;
  }
  sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }
  sub {
    bottom: -0.25em;
  }
  sup {
    top: -0.5em;
  }
  table {
    text-indent: 0;
    border-color: inherit;
    border-collapse: collapse;
  }
  :-moz-focusring {
    outline: auto;
  }
  progress {
    vertical-align: baseline;
  }
  summary {
    display: list-item;
  }
  ol, ul, menu {
    list-style: none;
  }
  img, svg, video, canvas, audio, iframe, embed, object {
    display: block;
    vertical-align: middle;
  }
  img, video {
    max-width: 100%;
    height: auto;
  }
  button, input, select, optgroup, textarea, ::file-selector-button {
    font: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    letter-spacing: inherit;
    color: inherit;
    border-radius: 0;
    background-color: transparent;
    opacity: 1;
  }
  :where(select:is([multiple], [size])) optgroup {
    font-weight: bolder;
  }
  :where(select:is([multiple], [size])) optgroup option {
    padding-inline-start: 20px;
  }
  ::file-selector-button {
    margin-inline-end: 4px;
  }
  ::placeholder {
    opacity: 1;
  }
  @supports (not (-webkit-appearance: -apple-pay-button))  or (contain-intrinsic-size: 1px) {
    ::placeholder {
      color: currentcolor;
      @supports (color: color-mix(in lab, red, red)) {
        color: color-mix(in oklab, currentcolor 50%, transparent);
      }
    }
  }
  textarea {
    resize: vertical;
  }
  ::-webkit-search-decoration {
    -webkit-appearance: none;
  }
  ::-webkit-date-and-time-value {
    min-height: 1lh;
    text-align: inherit;
  }
  ::-webkit-datetime-edit {
    display: inline-flex;
  }
  ::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }
  ::-webkit-datetime-edit, ::-webkit-datetime-edit-year-field, ::-webkit-datetime-edit-month-field, ::-webkit-datetime-edit-day-field, ::-webkit-datetime-edit-hour-field, ::-webkit-datetime-edit-minute-field, ::-webkit-datetime-edit-second-field, ::-webkit-datetime-edit-millisecond-field, ::-webkit-datetime-edit-meridiem-field {
    padding-block: 0;
  }
  ::-webkit-calendar-picker-indicator {
    line-height: 1;
  }
  :-moz-ui-invalid {
    box-shadow: none;
  }
  button, input:where([type='button'], [type='reset'], [type='submit']), ::file-selector-button {
    appearance: button;
  }
  ::-webkit-inner-spin-button, ::-webkit-outer-spin-button {
    height: auto;
  }
  [hidden]:where(:not([hidden='until-found'])) {
    display: none !important;
  }
}
@layer utilities {
  .collapse {
    visibility: collapse;
  }
  .container {
    width: 100%;
    @media (width >= 40rem) {
      max-width: 40rem;
    }
    @media (width >= 48rem) {
      max-width: 48rem;
    }
    @media (width >= 64rem) {
      max-width: 64rem;
    }
    @media (width >= 80rem) {
      max-width: 80rem;
    }
    @media (width >= 96rem) {
      max-width: 96rem;
    }
  }
  .mx-auto {
    margin-inline: auto;
  }
  .mt-2 {
    margin-top: calc(var(--spacing) * 2);
  }
  .mt-3 {
    margin-top: calc(var(--spacing) * 3);
  }
  .flex {
    display: flex;
  }
  .grid {
    display: grid;
  }
  .table {
    display: table;
  }
  .h-6 {
    height: calc(var(--spacing) * 6);
  }
  .min-h-screen {
    min-height: 100vh;
  }
  .w-6 {
    width: calc(var(--spacing) * 6);
  }
  .w-full {
    width: 100%;
  }
  .max-w-none {
    max-width: none;
  }
  .flex-1 {
    flex: 1;
  }
  .flex-none {
    flex: none;
  }
  .list-disc {
    list-style-type: disc;
  }
  .grid-cols-2 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
  .items-center {
    align-items: center;
  }
  .gap-2 {
    gap: calc(var(--spacing) * 2);
  }
  .gap-3 {
    gap: calc(var(--spacing) * 3);
  }
  .gap-4 {
    gap: calc(var(--spacing) * 4);
  }
  .overflow-x-auto {
    overflow-x: auto;
  }
  .fill-current {
    fill: currentcolor;
  }
  .p-4 {
    padding: calc(var(--spacing) * 4);
  }
  .p-6 {
    padding: calc(var(--spacing) * 6);
  }
  .px-4 {
    padding-inline: calc(var(--spacing) * 4);
  }
  .pr-4 {
    padding-right: calc(var(--spacing) * 4);
  }
  .pl-6 {
    padding-left: calc(var(--spacing) * 6);
  }
  .text-right {
    text-align: right;
  }
  .text-lg {
    font-size: var(--text-lg);
    line-height: var(--tw-leading, var(--text-lg--line-height));
  }
  .text-sm {
    font-size: var(--text-sm);
    line-height: var(--tw-leading, var(--text-sm--line-height));
  }
  .text-xs {
    font-size: var(--text-xs);
    line-height: var(--tw-leading, var(--text-xs--line-height));
  }
  .font-bold {
    --tw-font-weight: var(--font-weight-bold);
    font-weight: var(--font-weight-bold);
  }
  .font-medium {
    --tw-font-weight: var(--font-weight-medium);
    font-weight: var(--font-weight-medium);
  }
  .font-semibold {
    --tw-font-weight: var(--font-weight-semibold);
    font-weight: var(--font-weight-semibold);
  }
  .opacity-70 {
    opacity: 70%;
  }
  .opacity-80 {
    opacity: 80%;
  }
  .shadow {
    --tw-shadow: 0 1px 3px 0 var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 1px 2px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1));
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }
  .sm\:col-span-2 {
    @media (width >= 40rem) {
      grid-column: span 2 / span 2;
    }
  }
  .sm\:grid-cols-2 {
    @media (width >= 40rem) {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }
  .sm\:grid-cols-3 {
    @media (width >= 40rem) {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }
  .md\:col-span-2 {
    @media (width >= 48rem) {
      grid-column: span 2 / span 2;
    }
  }
  .md\:grid-cols-3 {
    @media (width >= 48rem) {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }
}
@property --tw-font-weight {
  syntax: "*";
  inherits: false;
}
@property --tw-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}
@property --tw-shadow-color {
  syntax: "*";
  inherits: false;
}
@property --tw-shadow-alpha {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 100%;
}
@property --tw-inset-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}
@property --tw-inset-shadow-color {
  syntax: "*";
  inherits: false;
}
@property --tw-inset-shadow-alpha {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 100%;
}
@property --tw-ring-color {
  syntax: "*";
  inherits: false;
}
@property --tw-ring-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}
@property --tw-inset-ring-color {
  syntax: "*";
  inherits: false;
}
@property --tw-inset-ring-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}
@property --tw-ring-inset {
  syntax: "*";
  inherits: false;
}
@property --tw-ring-offset-width {
  syntax: "<length>";
  inherits: false;
  initial-value: 0px;
}
@property --tw-ring-offset-color {
  syntax: "*";
  inherits: false;
  initial-value: #fff;
}
@property --tw-ring-offset-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}
@layer properties {
  @supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))) {
    *, ::before, ::after, ::backdrop {
      --tw-font-weight: initial;
      --tw-shadow: 0 0 #0000;
      --tw-shadow-color: initial;
      --tw-shadow-alpha: 100%;
      --tw-inset-shadow: 0 0 #0000;
      --tw-inset-shadow-color: initial;
      --tw-inset-shadow-alpha: 100%;
      --tw-ring-color: initial;
      --tw-ring-shadow: 0 0 #0000;
      --tw-inset-ring-color: initial;
      --tw-inset-ring-shadow: 0 0 #0000;
      --tw-ring-inset: initial;
      --tw-ring-offset-width: 0px;
      --tw-ring-offset-color: #fff;
      --tw-ring-offset-shadow: 0 0 #0000;
    }
  }
}
</style>
<link href="https://cdn.jsdelivr.net/npm/daisyui@5/themes.css" rel="stylesheet" type="text/css">
  <meta name="color-scheme" content="light dark">
  <style>
    .number-input { font-variant-numeric: tabular-nums; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  </style>
</head>
<body class="min-h-screen bg-base-200">
  <!-- Header -->
  <header class="navbar bg-base-100 shadow">
    <div class="flex-1">
      <span class="text-lg font-bold px-4">Wohnkosten â€“ proportional zum Netto (mit Sicherheitsmarge)</span>
    </div>
    <div class="flex-none gap-3 pr-4 items-center">
      <span class="text-sm opacity-70">Theme</span>
      <label class="swap swap-rotate">
        <input type="checkbox" id="themeToggle">
        <!-- Sonne -->
        <svg class="swap-off fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64 17l-.71.71a1 1 0 001.41 1.41l.71-.71A1 1 0 105.64 17zM5 12a1 1 0 00-1-1H3a1 1 0 000 2h1a1 1 0 001-1zm7-7a1 1 0 001-1V3a1 1 0 00-2 0v1a1 1 0 001 1zm7.36 3l.71-.71a1 1 0 10-1.41-1.41L18.95 6a1 1 0 001.41 1.41zM12 6.5A5.5 5.5 0 1017.5 12 5.51 5.51 0 0012 6.5zM21 11h-1a1 1 0 000 2h1a1 1 0 000-2zm-2.05 6.05a1 1 0 00-1.41 0l-.71.71a1 1 0 001.41 1.41l.71-.71a1 1 0 000-1.41zM12 21a1 1 0 001-1v-1a1 1 0 00-2 0v1a1 1 0 001 1zM6.05 5.64a1 1 0 001.41 0l.71-.71A1 1 0 006.76 3.5l-.71.71a1 1 0 000 1.41z"></path></svg>
        <!-- Mond -->
        <svg class="swap-on fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64 13A9 9 0 1111 2.36 7 7 0 0021.64 13z"></path></svg>
      </label>
    </div>
  </header>

  <main class="container mx-auto p-4 grid gap-4">
    <!-- Formel / ErklÃ¤rung -->
    <details class="collapse bg-base-100 shadow">
      <summary class="collapse-title text-md font-semibold">Formel &amp; Definition (aufklappen)</summary>
      <div class="collapse-content">
        <div class="prose max-w-none">
          <p><strong>Ziel:</strong> BetrÃ¤ge je Kategorie werden <em>rein proportional</em> zum Nettojahreseinkommen verteilt. Eine <strong>Sicherheitsmarge</strong> bleibt als Reserve. Du gibst nur dein Einkommen (und optional die Marge) ein.</p>
          <pre class="mono text-sm"><code>Sei:
  Net = Nettojahreseinkommen
  Tage = 365 (verÃ¤nderbar)
  m âˆˆ [0, 0.9] = Sicherheitsmarge (z.â€¯B. 0,10 = 10 %)
  w_k = Gewicht Kategorie k (nur VerhÃ¤ltnis zÃ¤hlt)
  W = Î£ w_k,   s_k = w_k / W

Dann je Kategorie k:
  Jahr_k  = Net Ã— (1 âˆ’ m) Ã— s_k
  Monat_k = Jahr_k / 12
  Tag_k   = Jahr_k / Tage

Reserve:
  Reserve_Jahr  = Net Ã— m
  Reserve_Monat = Reserve_Jahr / 12
  Reserve_Tag   = Reserve_Jahr / Tage
</code></pre>
          <p><em>Wichtig:</em> Es wird <strong>nie 100â€¯%</strong> des Nettoeinkommens verplant. Kategorien erhalten <strong>(1 âˆ’ Marge)</strong>, die <strong>Reserve</strong> sind <strong>Marge</strong>.</p>
        </div>
      </div>
    </details>

    <!-- Eingaben & Kennzahlen -->
    <section class="grid md:grid-cols-3 gap-4">
      <div class="card bg-base-100 shadow md:col-span-2">
        <div class="card-body">
          <h2 class="card-title">Eingaben</h2>
          <div class="grid sm:grid-cols-2 gap-4">
            <label class="form-control">
              <div class="label">
                <span class="label-text">Nettojahreseinkommen (â‚¬)</span>
              </div>
              <input id="netIncome" type="text" class="input input-bordered number-input" placeholder="z.â€¯B. 70000" inputmode="decimal" autocomplete="off">
              <div class="label">
                <span class="label-text-alt">Komma oder Punkt erlaubt (z.â€¯B. 70.000 oder 70000,00)</span>
              </div>
            </label>

            <label class="form-control">
              <div class="label">
                <span class="label-text">Sicherheitsmarge (%)</span>
                <span class="label-text-alt"><span id="mosLabel">90</span>%</span>
              </div>
              <input id="mos" type="range" min="0" max="90" step="1" value="10" class="range range-primary">
              <div class="label"><span class="label-text-alt">Standard: 10â€¯% (0â€“90â€¯%)</span></div>
            </label>
          </div>

          <details class="collapse bg-base-200/50 rounded-box mt-2">
            <summary class="collapse-title text-sm font-medium">Erweitert (optional)</summary>
            <div class="collapse-content">
              <div class="grid sm:grid-cols-3 gap-3">
                <div>
                  <label class="label"><span class="label-text">Tage pro Jahr</span></label>
                  <input id="daysPerYear" type="number" class="input input-bordered w-full number-input" value="365" min="1">
                </div>
                <div class="sm:col-span-2">
                  <p class="text-sm opacity-80">Gewichte (nur VerhÃ¤ltnis relevant):</p>
                  <div class="overflow-x-auto mt-2">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>Kategorie</th>
                          <th>Gewicht</th>
                          <th>Anteil</th>
                        </tr>
                      </thead>
                      <tbody id="weightsBody"><tr><td>Miete</td><td>
          <input class="input input-sm input-bordered w-full number-input" value="30" inputmode="decimal" oninput="onWeightChange(0, this.value)">
        </td><td>65,22&nbsp;%</td></tr><tr><td>Heizung</td><td>
          <input class="input input-sm input-bordered w-full number-input" value="6" inputmode="decimal" oninput="onWeightChange(1, this.value)">
        </td><td>13,04&nbsp;%</td></tr><tr><td>Warmwasser</td><td>
          <input class="input input-sm input-bordered w-full number-input" value="3" inputmode="decimal" oninput="onWeightChange(2, this.value)">
        </td><td>6,52&nbsp;%</td></tr><tr><td>Strom/Elektro</td><td>
          <input class="input input-sm input-bordered w-full number-input" value="2" inputmode="decimal" oninput="onWeightChange(3, this.value)">
        </td><td>4,35&nbsp;%</td></tr><tr><td>Nebenkosten</td><td>
          <input class="input input-sm input-bordered w-full number-input" value="5" inputmode="decimal" oninput="onWeightChange(4, this.value)">
        </td><td>10,87&nbsp;%</td></tr></tbody>
                    </table>
                  </div>
                  <div class="mt-2 flex gap-2">
                    <button id="resetWeightsBtn" class="btn btn-outline btn-sm">Standardgewichte</button>
                    <button id="normalizeBtn" class="btn btn-ghost btn-sm">Gewichte normalisieren (Summe=1)</button>
                  </div>
                  <p class="text-xs opacity-70 mt-2">Voreinstellung ist realistisch (Miete hoch gewichtet). Du musst hier nichts Ã¤ndern.</p>
                </div>
              </div>
            </div>
          </details>
        </div>
      </div>

      <!-- Schnell-Stats -->
      <div class="stats bg-base-100 shadow grid grid-cols-2">
        <div class="stat">
          <div class="stat-title">Netto pro Tag</div>
          <div class="stat-value text-primary" id="netPerDay">153,42&nbsp;â‚¬</div>
          <div class="stat-desc">= Netto / Tage</div>
        </div>
        <div class="stat">
          <div class="stat-title">Budget fÃ¼r Wohnen / Tag</div>
          <div class="stat-value text-success" id="budgetPerDay">15,34&nbsp;â‚¬</div>
          <div class="stat-desc">= Netto/Tag Ã— (1 âˆ’ Marge)</div>
        </div>
        <div class="stat">
          <div class="stat-title">Sicherheitsreserve / Tag</div>
          <div class="stat-value text-secondary" id="reservePerDay">138,08&nbsp;â‚¬</div>
          <div class="stat-desc">= Netto/Tag Ã— Marge</div>
        </div>
      </div>
    </section>

    <!-- Ergebnisse -->
    <section class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">Ergebnisse (automatisch verteilt)</h2>

        <div class="overflow-x-auto">
          <table class="table table-zebra">
            <thead>
              <tr>
                <th>Kategorie</th>
                <th>Anteil am Budget</th>
                <th>â‚¬ / Tag</th>
                <th>â‚¬ / Monat</th>
                <th>â‚¬ / Jahr</th>
              </tr>
            </thead>
            <tbody id="resultBody"><tr><td>Miete</td><td>65,22&nbsp;%</td><td>10,01&nbsp;â‚¬</td><td>304,35&nbsp;â‚¬</td><td>3.652,17&nbsp;â‚¬</td></tr><tr><td>Heizung</td><td>13,04&nbsp;%</td><td>2,00&nbsp;â‚¬</td><td>60,87&nbsp;â‚¬</td><td>730,43&nbsp;â‚¬</td></tr><tr><td>Warmwasser</td><td>6,52&nbsp;%</td><td>1,00&nbsp;â‚¬</td><td>30,43&nbsp;â‚¬</td><td>365,22&nbsp;â‚¬</td></tr><tr><td>Strom/Elektro</td><td>4,35&nbsp;%</td><td>0,67&nbsp;â‚¬</td><td>20,29&nbsp;â‚¬</td><td>243,48&nbsp;â‚¬</td></tr><tr><td>Nebenkosten</td><td>10,87&nbsp;%</td><td>1,67&nbsp;â‚¬</td><td>50,72&nbsp;â‚¬</td><td>608,70&nbsp;â‚¬</td></tr></tbody>
            <tfoot>
              <tr class="font-semibold">
                <td class="text-right">Summe Kategorien (Budget fÃ¼r Wohnen)</td>
                <td id="sumShareExplain">10â€¯% vom Netto (Budget)</td>
                <td id="sumDay">15,34&nbsp;â‚¬</td>
                <td id="sumMonth">466,67&nbsp;â‚¬</td>
                <td id="sumYear">5.600,00&nbsp;â‚¬</td>
              </tr>
              <tr>
                <td class="text-right">Sicherheitsreserve (nicht zugewiesen)</td>
                <td>â€”</td>
                <td id="resDay">138,08&nbsp;â‚¬</td>
                <td id="resMonth">4.200,00&nbsp;â‚¬</td>
                <td id="resYear">50.400,00&nbsp;â‚¬</td>
              </tr>
              <!-- Kein â€ž100â€¯% vom Nettoâ€œ mehr -->
            </tfoot>
          </table>
        </div>

        <div class="alert alert-info mt-3">
          <span>Es wird nur <strong>(1 âˆ’ Marge)</strong> deines Nettoeinkommens verteilt (Budget fÃ¼r Wohnen). <strong>Die Marge bleibt Reserve</strong> â€“ bewusst nicht verplant.</span>
        </div>
      </div>
    </section>

    <section class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">Hinweise</h2>
        <ul class="list-disc pl-6">
          <li>Nur <strong>Nettojahreseinkommen</strong> eingeben (und optional die <strong>Sicherheitsmarge</strong>) â€“ alles andere lÃ¤uft automatisch.</li>
          <li>Die Summe der Kategorien ist <strong>immer</strong> kleiner als 100â€¯%: genau <strong>(1 âˆ’ Marge)</strong>.</li>
          <li>Die Berechnung ist <strong>rein proportional</strong> zu den Gewichten; es werden <strong>keine fixen ProzentsÃ¤tze</strong> vorausgesetzt.</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="footer footer-center p-6 bg-base-100 text-base-content">
    <aside>
      <p class="text-sm opacity-70">Â© <span id="year">2025</span> Proportionale Wohnkosten â€¢ lokal &amp; statisch â€¢ daisyUI (CDN only)</p>
    </aside>
  </footer>

  <script>
    // Theme toggle
    const themeToggle = document.getElementById('themeToggle');
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    themeToggle.checked = savedTheme === 'dark';
    themeToggle.addEventListener('change', () => {
      const next = themeToggle.checked ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    });

    // Format helpers
    const nfEUR = new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR', maximumFractionDigits: 2 });
    const nfPct = new Intl.NumberFormat('de-DE', { style: 'percent', maximumFractionDigits: 2 });

    function parseNumber(input) {
      if (typeof input === 'number') return input;
      if (!input) return 0;
      // Erlaube "70.000,50", "70000,50", "70000.50"
      const s = String(input).trim().replace(/\s/g, '').replace(/\./g, '').replace(',', '.');
      const v = Number(s);
      return isFinite(v) ? v : 0;
    }

    // Kategorien (nur VerhÃ¤ltnis zÃ¤hlt) â€“ realistische Standardgewichte:
    // Summe 46 -> Miete ~65% vom Budget (zugewiesener Topf)
    const defaultCategories = [
      { key: 'miete',      name: 'Miete',        weight: 30 },
      { key: 'heizung',    name: 'Heizung',      weight:  6 },
      { key: 'warmwasser', name: 'Warmwasser',   weight:  3 },
      { key: 'strom',      name: 'Strom/Elektro',weight:  2 },
      { key: 'neben',      name: 'Nebenkosten',  weight:  5 }
    ];
    let categories = JSON.parse(JSON.stringify(defaultCategories));

    // DOM Refs
    const netIncomeInput = document.getElementById('netIncome');
    const mosInput       = document.getElementById('mos');
    const mosLabel       = document.getElementById('mosLabel');
    const daysPerYearInp = document.getElementById('daysPerYear');

    const weightsBody    = document.getElementById('weightsBody');

    const netPerDayEl    = document.getElementById('netPerDay');
    const budgetPerDayEl = document.getElementById('budgetPerDay');
    const reservePerDayEl= document.getElementById('reservePerDay');

    const resultBody     = document.getElementById('resultBody');
    const sumShareExplain= document.getElementById('sumShareExplain');
    const sumDayEl       = document.getElementById('sumDay');
    const sumMonthEl     = document.getElementById('sumMonth');
    const sumYearEl      = document.getElementById('sumYear');

    const resDayEl       = document.getElementById('resDay');
    const resMonthEl     = document.getElementById('resMonth');
    const resYearEl      = document.getElementById('resYear');

    document.getElementById('year').textContent = new Date().getFullYear();

    function totalWeight() {
      return categories.reduce((acc, c) => acc + (parseNumber(c.weight) || 0), 0);
    }
    function shares() {
      const tw = totalWeight() || 1;
      return categories.map(c => {
        const w = parseNumber(c.weight) || 0;
        return { ...c, share: w / tw };
      });
    }

    function renderWeightsEditor() {
      weightsBody.innerHTML = '';
      const s = shares();
      s.forEach((row, idx) => {
        const tr = document.createElement('tr');

        const tdName = document.createElement('td');
        tdName.textContent = row.name;

        const tdWeight = document.createElement('td');
        tdWeight.innerHTML = `
          <input class="input input-sm input-bordered w-full number-input"
                 value="${String(row.weight).replace('.', ',')}"
                 inputmode="decimal"
                 oninput="onWeightChange(${idx}, this.value)" />
        `;

        const tdShare = document.createElement('td');
        tdShare.textContent = nfPct.format(row.share);

        tr.appendChild(tdName);
        tr.appendChild(tdWeight);
        tr.appendChild(tdShare);
        weightsBody.appendChild(tr);
      });
    }
    window.onWeightChange = (idx, val) => {
      categories[idx].weight = (val === '' ? 0 : parseNumber(val));
      renderAll();
    };

    function renderResults() {
      const net = parseNumber(netIncomeInput.value);
      const days = Math.max(1, parseInt(daysPerYearInp.value || '365', 10));
      const mPct = Math.min(90, Math.max(0, parseInt(mosInput.value || '0', 10)));
      const m = mPct / 100;
      mosLabel.textContent = String(mPct);

      const netYear  = net;
      const netMonth = netYear / 12;
      const netDay   = netYear / days;

      const reserveYear  = netYear * m;
      const reserveMonth = reserveYear / 12;
      const reserveDay   = reserveYear / days;

      const assignYear  = netYear * (1 - m);
      const assignMonth = assignYear / 12;
      const assignDay   = assignYear / days;

      netPerDayEl.textContent     = isFinite(netDay) ? nfEUR.format(netDay) : 'â€“';
      budgetPerDayEl.textContent  = isFinite(assignDay) ? nfEUR.format(assignDay) : 'â€“';
      reservePerDayEl.textContent = isFinite(reserveDay) ? nfEUR.format(reserveDay) : 'â€“';

      resultBody.innerHTML = '';
      const s = shares();
      let sumD = 0, sumM = 0, sumY = 0;
      s.forEach(row => {
        const y = assignYear * row.share;
        const mth = y / 12;
        const d = y / days;

        sumY += y; sumM += mth; sumD += d;

        const tr = document.createElement('tr');

        const tdName = document.createElement('td');
        tdName.textContent = row.name;

        const tdShare = document.createElement('td');
        tdShare.textContent = nfPct.format(row.share); // Anteil am Budget

        const tdDay = document.createElement('td');
        tdDay.textContent = nfEUR.format(d);

        const tdMonth = document.createElement('td');
        tdMonth.textContent = nfEUR.format(mth);

        const tdYear = document.createElement('td');
        tdYear.textContent = nfEUR.format(y);

        tr.appendChild(tdName);
        tr.appendChild(tdShare);
        tr.appendChild(tdDay);
        tr.appendChild(tdMonth);
        tr.appendChild(tdYear);
        resultBody.appendChild(tr);
      });

      // Footer: nur Budget (Summe Kategorien) + Reserve â€” kein â€ž100 % vom Nettoâ€œ
      sumShareExplain.textContent = `${(100 - mPct).toFixed(0)}â€¯% vom Netto (Budget)`;
      sumDayEl.textContent    = nfEUR.format(sumD);
      sumMonthEl.textContent  = nfEUR.format(sumM);
      sumYearEl.textContent   = nfEUR.format(sumY);

      resDayEl.textContent    = nfEUR.format(reserveDay);
      resMonthEl.textContent  = nfEUR.format(reserveMonth);
      resYearEl.textContent   = nfEUR.format(reserveYear);
    }

    function renderAll() {
      renderWeightsEditor();
      renderResults();
    }

    // Buttons / Events
    document.getElementById('resetWeightsBtn').addEventListener('click', () => {
      categories = JSON.parse(JSON.stringify(defaultCategories));
      renderAll();
    });
    document.getElementById('normalizeBtn').addEventListener('click', () => {
      const tw = totalWeight() || 1;
      categories = categories.map(c => ({ ...c, weight: c.weight / tw }));
      renderAll();
    });

    netIncomeInput.addEventListener('input', renderResults);
    mosInput.addEventListener('input', renderResults);
    daysPerYearInp.addEventListener('input', renderResults);

    // Init: Demo-Werte setzen, sofort Ergebnisse zeigen
    netIncomeInput.value = '56000';
    document.getElementById('year').textContent = new Date().getFullYear();
    renderAll();
  </script>

</body></html>
